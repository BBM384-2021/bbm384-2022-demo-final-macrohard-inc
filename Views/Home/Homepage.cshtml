@model Tuple<LinkedHUCENGv2.Models.UserProfileModel, List<LinkedHUCENGv2.Models.PostViewModel>>
@{
    Layout = "~/Views/Home/layout.cshtml";
}
<!DOCTYPE html>
<html lan="en" style="height: auto;">

<head>
    <link rel="stylesheet" href="~/css/profile.css?v=3.4.1"/>
    <link rel="stylesheet" href="~/css/feed.css?v=3.4.1"/>
    <link href="~/js/userProfile.js"/>
</head>

<div class="wrapper" style="position: relative;" style="z-index: 0;">
    <div class="profileBodyContainer">
        <div class="profileBody">
            <img src="~/img/studentback.png" style="width: 100%; border-radius: 20px 20px 0px 0px;height: 75%;">
            <div class="profile-grid-container">
                <div class = "studentProfile" style = "margin-top:-40px;height:120px;width:120px;" >
                    <img src="~/img/@Model.Item1.ProfilePhoto" style=" height: 100%;width:100%; border-radius:10px;position: relative;">
                </div>
                <div class="profileText" >
                    <h1 style="text-align: left;">
                        @Model.Item1.FirstName @Model.Item1.LastName
                    </h1>
                    <p style="text-align: left;font-weight: bolder;">
                        <a asp-controller="Follow" asp-action="GetFollowingList" asp-route-userId="@Model.Item1.Id" style ="text-decoration:none">Followings</a>
                        @Model.Item1.FollowingCount
                        <a asp-controller="Follow" asp-action="GetFollowersList" asp-route-userId="@Model.Item1.Id" style ="text-decoration:none">Followers</a>
                        @Model.Item1.FollowersCount
                    </p>
                    <p style="text-align: left; font-weight: lighter;">
                        @Model.Item1.ProfileBio
                    </p>

                </div>
            </div>
        </div>
    </div>
    <div style = "width:80%;display:flex;justify-content:center">
            
        <div class="posts " style="background-color:white;height:0.5px; border-radius:20px;box-shadow: 0px 0px 50px rgba(128, 0, 255, 0.1);background-color:#8080802b;padding :0;margin:0px 80px 30px 80px;
                justify-content:center;width:85%;margin-top:20px;margin-bottom:50px;">

        </div>
    </div>
    @foreach (var item in Model.Item2)
    {
        <div style = "width:80%;display:flex;justify-content:center">
            <div class="posts " style="background-color:white;height:fit-content; border-radius:20px;box-shadow: 0px 0px 50px rgba(128, 0, 255, 0.1);margin:0px 80px 30px 80px;
                justify-content:center;width:80%;">
                <div class = "postColumnContainer" >
                    <div style = "width:3em;height:3em;">
                        <img src="~/img/@item.PosterAccount.ProfilePhoto" style=" height: 100%;width:100%; border-radius:10px;position: relative; ">
                    </div>
                    <div>
                        <p style = "font-weight:bold;color:#240046">@item.FirstName @item.LastName</p>
                        <p style = "font-weight:100;color:#995cd3;font-size:13px;">@item.AccountType</p>
                         <div style="display:inline-grid;grid-template-columns:auto auto;column-gap:5px">
                                                                        @if (item.PostTime >= 24)
                                                                        {
                                                                        var i = (int)item.PostTime / 24;
                                                                        var j = (int)item.PostTime % 24;
                                                                        <p style="font-weight:100;color:#995cd3;font-size:13px;">@i day @j hours ago</p>
                                                                        }
                                                                        @if (item.PostTime <= 24 && item.PostTime >= 1)
                                                                        {
                                                                            var s = (int)item.PostTime;
                                                                            <p style="font-weight:100;color:#995cd3;font-size:13px;">@s hours ago</p>
                                                                        }
                                                                        @if (item.PostTime < 1)
                                                                        {
                                                                            var x = Convert.ToInt32(item.PostTime * 60);
                                                                            <p style="font-weight:100;color:#995cd3;font-size:13px;">@x minutes ago</p>
                                                                        }
                                                                        <p style="font-weight:bold;color:#240046;font-size:13px;background-color:#8000ff17;width:fit-content;padding:0 20px 0 20px;border-radius:10px">@item.PostType</p>
                                                                    </div>
                        <p style = "font-weight:300;color:black;margin-top:10px;padding-bottom:20px;border-bottom: 0.5px solid #8080802b;margin-bottom:10px">@item.PostContent</p>
                        <div style = "display:inline-grid;grid-template-columns:auto auto;height:20px;column-gap:20px;margin-top:10px;">
                            <div style = "display:flex;justify-content:center" onclick = "likeToggle('@item.PostId')">
                                <button style = "display:inline-grid;grid-template-columns:auto auto;background-color:transparent;border:none;width:auto;" >
                                    <svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="20" height="20" viewBox="0 0 816 816">
                                        <path id = "@("likeSVG" + item.PostId)" fill="none" fill-rule="evenodd" stroke="#CBCBCB" stroke-width="40" d="M 408,223.824 C 476.78,101.333 612.625,102.281 680.12,164.239 C 747.613,226.196 746.755,349.161 677.973,471.652 C 629.783,563.545 506.877,654.916 404.565,715.687 C 303.111,653.493 181.493,560.415 134.591,467.859 C 67.5267,344.42 68.3853,221.453 136.737,160.445 C 205.089,99.4373 340.935,100.385 408,223.824 Z "/>
                                    </svg>
                                
                                    <p class = "commentLikeButton" id = "@("likeButton" + item.PostId)" style = "font-weight:bold;padding:2px 0 0 5px;">Like</p>
                                </button>
                            </div>
                            <div  onclick = "commentToggle('@item.PostId')">
                                <button  style = "display:inline-grid;grid-template-columns:auto auto;background-color:transparent;border:none;width:auto;">
                                    <svg  width="20" height="20" viewBox="0 0 35 34" fill="none" xmlns="http://www.w3.org/2000/svg">
                                        <path id = "@("commentSVG" + item.PostId)" d="M8.74293 25.4155C9.26336 25.7597 9.51637 26.3901 9.37829 26.9986L8.6219 30.3319C8.61713 30.3529 8.61191 30.3738 8.60624 30.3946C8.37535 31.2412 8.39844 31.6554 8.4267 31.8219C8.53703 31.8244 8.74423 31.8044 9.0957 31.6939C10.6907 31.1926 13.2477 29.3561 15.5436 26.5501C15.9151 26.096 16.5171 25.9002 17.0846 26.0489C18.3683 26.3851 20.2317 26.3329 22.2018 25.9886C24.135 25.6507 25.9746 25.0668 27.1658 24.4936C29.581 23.2205 33.5 19.7707 33.5 14.5833C33.5 12.2576 32.8191 10.1133 31.4259 8.1154C30.0234 6.10427 28.108 4.49556 25.6353 3.29821C23.1702 2.10452 20.4659 1.49992 17.5 1.49992C14.5341 1.49992 11.8298 2.10452 9.36466 3.29821C6.89195 4.49556 4.97657 6.10427 3.57414 8.1154C2.1809 10.1133 1.5 12.2576 1.5 14.5833C1.5 16.5888 2.01474 18.4597 3.05827 20.222C3.52726 21.014 4.41347 21.9725 5.51016 22.9418C6.58524 23.8919 7.77089 24.7726 8.74293 25.4155ZM8.32108 31.807C8.3209 31.8072 8.32407 31.8088 8.33117 31.8108C8.32483 31.8077 8.32127 31.8067 8.32108 31.807Z" 
                                              stroke="#CBCBCB" stroke-width="2" stroke-linejoin="round" fill = "none"/>
                                    </svg>
                                    <p class = "commentLikeButton" id = "@("commentButton" + item.PostId)" style = "font-weight:bold;padding:2px 0 0 5px;">Comment</p>
                                </button>
                            </div>
                        </div>
                        <div class = "commentContainer" id = "@("commentContainer" + item.PostId)" style = "width:100%;height:fit-content;margin-top:3px;border-top: 0.5px solid #8080802b;">
                            <div style = "height:fit-content;width:100%">
                                <div class = "postColumnContainer" style = "padding-top:10px;padding-bottom:10px;grid-template-columns: 3em 80% 10%;" >
                                
                                    <div style = "width:3em;height:3em;">
                                        <img src="~/img/@item.PosterAccount.ProfilePhoto" style=" height: 100%;width:100%; border-radius:10px;position: relative; ">
                                    </div>
                                
                                    <div style = "margin-top:0.5em">
                                        <textarea name="commentContent" placeholder="Comment Here" id="myCommentArea" style = "border:1px solid #2400463d;border-radius:10px"></textarea>
                                    </div>
                                    <input type="submit" value="Comment" class="btn btn-primary" style = "margin-top:0.5em;background-color:#240046" />
                                </div>
                                <div class = "commentOnPost" style="padding-top:10px;border-top: 0.5px solid #8080802b;">
                                    <div class = "postColumnContainer" style = "grid-template-columns: 3em 80% 10px;">
                                        <div style = "width:3em;height:3em;">
                                            <img src="~/img/@item.PosterAccount.ProfilePhoto" style=" height: 100%;width:100%; border-radius:10px;position: relative; ">
                                        </div>
                                        <div>
                                            <p style = "font-weight:bold;color:#240046">@item.FirstName @item.LastName</p>
                                            <p style = "font-weight:100;color:#995cd3;font-size:13px;">@item.AccountType</p>
                                            <div style="display:inline-grid;grid-template-columns:auto auto;column-gap:5px">
                                                @if (item.PostTime >= 24)
                                                {
                                                var i = (int)item.PostTime / 24;
                                                var j = (int)item.PostTime % 24;
                                                <p style="font-weight:100;color:#995cd3;font-size:13px;">@i day @j hours ago</p>
                                                }
                                                @if (item.PostTime <= 24 && item.PostTime >= 1)
                                                {
                                                    var s = (int)item.PostTime;
                                                    <p style="font-weight:100;color:#995cd3;font-size:13px;">@s hours ago</p>
                                                }
                                                @if (item.PostTime < 1)
                                                {
                                                    var x = Convert.ToInt32(item.PostTime * 60);
                                                    <p style="font-weight:100;color:#995cd3;font-size:13px;">@x minutes ago</p>
                                                }
                                                <p style="font-weight:bold;color:#240046;font-size:13px;background-color:#8000ff17;width:fit-content;padding:0 20px 0 20px;border-radius:10px">@item.PostType</p>
                                            </div>
                                            <div style = "height:fit-content;width:fit-content;background-color:#E8E6EE;border-radius:10px;margin-top:10px;">
                                                <p style = "padding:5px 10px 5px 10px;" >Hello</p>
                                            </div>
                                        </div>

                                    </div>
                                </div>

                            </div>
                        </div>


                    </div>
                    <div>
                        @if (User.Identity.Name == @item.Email)
                        {


                            <a asp-action="DeleteOnFeed" asp-controller="Post" asp-route-id="@item.PostId" asp-route-userId="@item.PosterId" 
                               style = "font-weight:bold;text-decoration:none ; color:black" >X</a>
                        }
                    </div>

                </div>
            </div>


        </div> 
    }
</div>
<script type = "text/javascript">
    const myText = document.getElementById("myCommentArea" );
        
    myText.addEventListener("input",function(){
            console.log(this.scrollHeight);
            this.style.height = "33px";
            this.style.height = `${this.scrollHeight}px`
            
    });
    function commentToggle(i){
        var commentSvg = document.getElementById("commentSVG"+i);
        var commentButton = document.getElementById("commentButton"+i);
        var container = document.getElementById("commentContainer" + i);
        container.classList.toggle("hideComment");
        commentButton.classList.toggle("colorCommentLike");
        if(commentSvg.getAttribute("stroke") == "#CBCBCB"){
            commentSvg.setAttribute("stroke","#8000FF");
            commentSvg.setAttribute("fill","#8000FF");
            
        }
        else{
            commentSvg.setAttribute("stroke","#CBCBCB");
            commentSvg.setAttribute("fill","none");
        }
    };
    function likeToggle(i){
        var likeSvg = document.getElementById("likeSVG"+i);
        var likeButton = document.getElementById("likeButton"+i);
        likeButton.classList.toggle("colorCommentLike");
        if(likeSvg.getAttribute("stroke") == "#CBCBCB"){
            likeSvg.setAttribute("stroke","#8000FF");
            likeSvg.setAttribute("fill","#8000FF");
            
        }
        else{
            likeSvg.setAttribute("stroke","#CBCBCB");
            likeSvg.setAttribute("fill","none");
        }
    }
    const myCommentText = document.getElementById("myCommentArea" );
        
    myCommentText.addEventListener("input",function(){
            console.log(this.scrollHeight);
            this.style.height = "33px";
            this.style.height = `${this.scrollHeight}px`       
    });
</script>
</html>